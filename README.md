## Forgotten Story

**Forgotten Story** is a private, AI-assisted journaling app designed to help you capture moments, track your mood, digitize handwritten pages, and rediscover memories over time.

Built with **Next.js**, **TypeScript**, **Tailwind CSS**, and **Supabase**.

### Live demo
- **Production**: [forgottenstory.ryanchau.ca](https://forgottenstory.ryanchau.ca)
- **Vercel fallback**: [v0-forgotten-story-17xdbldmub9.vercel.app](https://v0-forgotten-story-17xdbldmub9.vercel.app)

### Highlights
- **Journal entries**: create/edit entries with date, mood, tags, and images
- **Handwriting → text (OCR)**: extract text from images using a Supabase Edge Function backed by **Google Gemini**
- **AI insights**: generate a story-like title summary + affirmation list for an entry
- **Search + filters**: find entries by text, tags, and date range
- **Auth**: Supabase Auth with Google OAuth
- **Email reminders**: opt-in reminders to revisit past entries (Supabase Edge Functions)

---

## Tech stack
- **Next.js (App Router)** + **TypeScript**
- **Tailwind CSS** + **shadcn/ui**
- **Supabase**: Postgres, Auth, Storage, Edge Functions
- **Gemini API** (via Supabase Edge Functions) for OCR + journaling insights

---

## How it works (high level)
- The UI lives in `app/` and uses Supabase Auth for sessions.
- OCR requests hit `app/api/extract-text`, which calls the Supabase Edge Function `gemini-ocr`.
- AI insights are generated by `app/api/entries/generate-ai`, which invokes the Supabase Edge Function `generate-ai-content`.

---

## Local development

### Prerequisites
- Node.js 18+
- pnpm
- A Supabase project

### Install

```bash
pnpm install
pnpm dev
```

### Environment variables (Next.js)
Create `.env.local`:

```env
NEXT_PUBLIC_SUPABASE_URL=your-supabase-project-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key

# Used for links in emails (recommended for prod)
NEXT_PUBLIC_SITE_URL=http://localhost:3000
```

### Supabase database schema
Run the schema in your Supabase SQL editor:
- `supabase/schema.sql`

### Supabase Auth (Google)
Configure Google as a provider in **Supabase Dashboard → Authentication → Providers → Google**, then ensure your redirect URLs include:
- `http://localhost:3000/auth/callback`
- `https://your-domain/auth/callback`

---

## Supabase Edge Functions (OCR, AI, email)
This repo contains Edge Functions in `supabase/functions/`.

### Required secrets
Set these in **Supabase Dashboard → Edge Functions → Secrets**:
- `GEMINI_API_KEY`
- `GEMINI_OCR_MODEL` (example: `gemini-2.5-flash` or `gemini-2.5-pro`)
- `GEMINI_SUMMARY_MODEL` (example: `gemini-2.5-pro`)

Email functions also expect:
- `SITE_URL` (your public site URL)
- Provider keys like `BREVO_API_KEY`, `SENDER_EMAIL`, `SENDER_NAME` (if using email reminders)

---

## Security & privacy
- **Row Level Security (RLS)** is enabled so users can only access their own rows. Policies live in `supabase/schema.sql`.
- Supabase **anon** keys are public by design; security comes from **RLS + Auth**.
- Never commit real secrets. This repo ignores `.env*` via `.gitignore`.

---

## Roadmap (short)
- Improve OCR UX (progress + better error messages)
- Add predictable AI cost controls (cap affirmations + max output tokens)
- Expand “On this day” reminders + scheduling options

---

## Contributing
If you spot a bug or have an idea, open an issue or PR. This is a portfolio project, so clarity and maintainability matter more than cleverness.
